{"title":"Fruit Consumption Analysis","markdown":{"yaml":{"title":"Fruit Consumption Analysis","subtitle":"__R:dplyr, ggplot","execute":{"keep-md":true,"warning":false},"format":{"html":{"code-fold":true,"code-line-numbers":true,"fig-width":10.5,"fig-height":7.5}}},"headingText":"Elevator pitch","containsRefs":false,"markdown":"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(pander)\nlibrary(ggrepel)\n```\n:::\n\nI notice that countries in Asia follow the pattern about consuming of fruit. In China, they eat more fruit than Japan and South Korea even though they have less GDP. By making graph, I learned the skills that add annotate and add text in the graph by using a geom_label_repel function. Also, I learned how to design scale on axis in graph1 by using scale continuous.\n\n## Running Code\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read.csv(\"C:/Users/gakyeong/Documents/GitHub/DS350_WI23_Bae_Gaky/week_05/fruit-consumption-vs-gdp-per-capita.csv\")\n\ndf1 <- df %>%\n  rename(fruit = \"Fruit...00002919....Food.available.for.consumption...0645pc....kilograms.per.year.per.capita\", gdp = \"GDP.per.capita..PPP..constant.2017.international...\" )%>% drop_na()\n  \ndf1[df1 == \"\"]<-NA\n\ndf1 <-df1 %>% \n  filter(Year >= 2015)%>%\n  fill(Continent, .direction=\"down\")%>%\n  filter(Year == 2019)\npander(df1)\n```\n\n::: {.cell-output-display}\n---------------------------------------------------------------------------------\n            Entity                Code     Year   fruit    gdp       Continent   \n------------------------------ ---------- ------ ------- -------- ---------------\n         Afghanistan              AFG      2019   39.45    2065        Asia      \n\n           Albania                ALB      2019   179.6   13657       Europe     \n\n           Algeria                DZA      2019   108.4   11522       Africa     \n\n            Angola                AGO      2019   76.34    6670       Africa     \n\n     Antigua and Barbuda          ATG      2019   131.7   21850    North America \n\n          Argentina               ARG      2019   80.54   22066    South America \n\n           Armenia                ARM      2019    116    13654        Asia      \n\n          Australia               AUS      2019   65.07   49309       Oceania    \n\n           Austria                AUT      2019   92.75   55834       Europe     \n\n          Azerbaijan              AZE      2019   85.5    14442        Asia      \n\n           Bahamas                BHS      2019   145.6   36433    North America \n\n          Bangladesh              BGD      2019   28.76    4754        Asia      \n\n           Barbados               BRB      2019   68.3    15639    North America \n\n           Belarus                BLR      2019   74.19   19279       Europe     \n\n           Belgium                BEL      2019   99.09   51944       Europe     \n\n            Belize                BLZ      2019   105.9    7252    North America \n\n            Benin                 BEN      2019   43.8     3287       Africa     \n\n           Bolivia                BOL      2019   94.48    8724    South America \n\n    Bosnia and Herzegovina        BIH      2019   90.25   14897       Europe     \n\n           Botswana               BWA      2019   26.18   16348       Africa     \n\n            Brazil                BRA      2019   98.92   14764    South America \n\n           Bulgaria               BGR      2019   61.66   23266       Europe     \n\n         Burkina Faso             BFA      2019   5.21     2176       Africa     \n\n           Burundi                BDI      2019   79.06   751.7       Africa     \n\n           Cambodia               KHM      2019   14.99    4389        Asia      \n\n           Cameroon               CMR      2019   110.4    3743       Africa     \n\n            Canada                CAN      2019   96.76   49172    North America \n\n          Cape Verde              CPV      2019   46.86    7172       Africa     \n\n   Central African Republic       CAF      2019   52.44   945.1       Africa     \n\n             Chad                 TCD      2019   7.38     1580       Africa     \n\n            Chile                 CHL      2019   56.3    24968    South America \n\n            China                 CHN      2019   102.4   15978        Asia      \n\n           Colombia               COL      2019    145    14585    South America \n\n           Comoros                COM      2019   32.06    3059       Africa     \n\n            Congo                 COG      2019   44.07    3826       Africa     \n\n          Costa Rica              CRI      2019   114.1   20938    North America \n\n        Cote d'Ivoire             CIV      2019   67.27    5213       Africa     \n\n           Croatia                HRV      2019   72.99   29336       Europe     \n\n            Cyprus                CYP      2019   74.65   41522       Europe     \n\n           Czechia                CZE      2019   55.73   40981       Europe     \n\n Democratic Republic of Congo     COD      2019   64.21    1098       Africa     \n\n           Denmark                DNK      2019   59.68   57162       Europe     \n\n           Djibouti               DJI      2019   30.44    5535       Africa     \n\n           Dominica               DMA      2019   365.6   12369    North America \n\n      Dominican Republic          DOM      2019   354.8   18413    North America \n\n           Ecuador                ECU      2019   57.6    11371    South America \n\n            Egypt                 EGY      2019   93.34   11763       Africa     \n\n         El Salvador              SLV      2019   68.48    8776    North America \n\n           Estonia                EST      2019   75.44   36401       Europe     \n\n           Eswatini               SWZ      2019   94.51    8653       Africa     \n\n           Ethiopia               ETH      2019   8.81     2221       Africa     \n\n             Fiji                 FJI      2019   38.21   13684       Oceania    \n\n           Finland                FIN      2019   73.06   48583       Europe     \n\n            France                FRA      2019   91.16   46018       Europe     \n\n            Gabon                 GAB      2019   134.1   14946       Africa     \n\n            Gambia                GMB      2019   6.841    2225       Africa     \n\n           Georgia                GEO      2019   49.31   14989        Asia      \n\n           Germany                DEU      2019   75.48   53930       Europe     \n\n            Ghana                 GHA      2019   202.3    5540       Africa     \n\n            Greece                GRC      2019    144    29698       Europe     \n\n           Grenada                GRD      2019   119.7   16868    North America \n\n          Guatemala               GTM      2019   48.54    8653    North America \n\n            Guinea                GIN      2019   89.86    2567       Africa     \n\n        Guinea-Bissau             GNB      2019   54.21    1939       Africa     \n\n            Guyana                GUY      2019    164    13082    South America \n\n            Haiti                 HTI      2019   98.42    3073    North America \n\n           Honduras               HND      2019   55.77    5736    North America \n\n          Hong Kong               HKG      2019   74.32   59586        Asia      \n\n           Hungary                HUN      2019   71.83   32554       Europe     \n\n           Iceland                ISL      2019   87.39   56936       Europe     \n\n            India                 IND      2019   63.55    6714        Asia      \n\n          Indonesia               IDN      2019   68.97   11812        Asia      \n\n             Iran                 IRN      2019   144.2   12389        Asia      \n\n             Iraq                 IRQ      2019   66.71   10936        Asia      \n\n           Ireland                IRL      2019   68.41   86650       Europe     \n\n            Israel                ISR      2019   107.4   40626        Asia      \n\n            Italy                 ITA      2019    123    42708       Europe     \n\n           Jamaica                JAM      2019    109     9777    North America \n\n            Japan                 JPN      2019   33.35   42022        Asia      \n\n            Jordan                JOR      2019   39.81   10071        Asia      \n\n          Kazakhstan              KAZ      2019   49.3    26352        Asia      \n\n            Kenya                 KEN      2019   64.68    4453       Africa     \n\n           Kiribati               KIR      2019   73.91    2340       Oceania    \n\n            Kuwait                KWT      2019   57.73   49854        Asia      \n\n          Kyrgyzstan              KGZ      2019   32.63    5258        Asia      \n\n             Laos                 LAO      2019   130.2    7887        Asia      \n\n            Latvia                LVA      2019    49     31012       Europe     \n\n           Lebanon                LBN      2019   85.26   14564        Asia      \n\n           Lesotho                LSO      2019   16.02    2584       Africa     \n\n           Liberia                LBR      2019   40.14    1470       Africa     \n\n            Libya                 LBY      2019   71.53   15174       Africa     \n\n          Lithuania               LTU      2019   47.31   37166       Europe     \n\n          Luxembourg              LUX      2019   86.87   116518      Europe     \n\n            Macao                 MAC      2019   57.34   127273       Asia      \n\n          Madagascar              MDG      2019   42.9     1619       Africa     \n\n            Malawi                MWI      2019   190.1    1537       Africa     \n\n           Malaysia               MYS      2019   41.15   28421        Asia      \n\n           Maldives               MDV      2019   71.31   19510        Asia      \n\n             Mali                 MLI      2019   66.26    2322       Africa     \n\n            Malta                 MLT      2019   80.94   43951       Europe     \n\n          Mauritania              MRT      2019   13.13    5344       Africa     \n\n          Mauritius               MUS      2019   40.98   22870       Africa     \n\n            Mexico                MEX      2019   120.3   19677    North America \n\n           Moldova                MDA      2019   127.2   13027       Europe     \n\n           Mongolia               MNG      2019   12.08   12486        Asia      \n\n          Montenegro              MNE      2019   151.8   21534       Europe     \n\n           Morocco                MAR      2019   108.5    7547       Africa     \n\n          Mozambique              MOZ      2019   30.85    1282       Africa     \n\n           Myanmar                MMR      2019   48.29    4740        Asia      \n\n           Namibia                NAM      2019   27.62    9813       Africa     \n\n            Nepal                 NPL      2019   54.71    3953        Asia      \n\n         Netherlands              NLD      2019   101.6   56784       Europe     \n\n         New Zealand              NZL      2019   57.38   42878       Oceania    \n\n          Nicaragua               NIC      2019   46.46    5452    North America \n\n            Niger                 NER      2019   25.32    1224       Africa     \n\n           Nigeria                NGA      2019   54.93    5135       Africa     \n\n        North America              NA      2019   110.5   61251       Africa     \n\n       North Macedonia            MKD      2019   113.6   16773       Europe     \n\n            Norway                NOR      2019   77.24   64385       Europe     \n\n             Oman                 OMN      2019   134.1   31284        Asia      \n\n           Pakistan               PAK      2019   35.6     4698        Asia      \n\n            Panama                PAN      2019   76.47   31440    North America \n\n       Papua New Guinea           PNG      2019   259.8    4293       Oceania    \n\n           Paraguay               PRY      2019   76.08   12616    South America \n\n             Peru                 PER      2019   130.9   12854    South America \n\n         Philippines              PHL      2019    101     8915        Asia      \n\n            Poland                POL      2019   61.83   33185       Europe     \n\n           Portugal               PRT      2019   131.6   34946       Europe     \n\n           Romania                ROU      2019   107.1   29875       Europe     \n\n            Russia                RUS      2019   61.24   27211       Europe     \n\n            Rwanda                RWA      2019   179.2    2228       Africa     \n\n    Saint Kitts and Nevis         KNA      2019   68.42   28603    North America \n\n         Saint Lucia              LCA      2019   87.97   15201    North America \n\n    Saint Vincent and the         VCT      2019   153.9   12489    North America \n          Grenadines                                                             \n\n            Samoa                 WSM      2019   177.3    6632       Oceania    \n\n    Sao Tome and Principe         STP      2019   210.3    4005       Africa     \n\n         Saudi Arabia             SAU      2019   69.65   46962        Asia      \n\n           Senegal                SEN      2019   19.36    3361       Africa     \n\n            Serbia                SRB      2019    105    18307       Europe     \n\n          Seychelles              SYC      2019   86.19   27611       Africa     \n\n         Sierra Leone             SLE      2019   33.74    1705       Africa     \n\n           Slovakia               SVK      2019   51.61   31928       Europe     \n\n           Slovenia               SVN      2019   95.6    38947       Europe     \n\n       Solomon Islands            SLB      2019   42.1     2661       Oceania    \n\n         South Africa             ZAF      2019   27.14   13710       Africa     \n\n         South Korea              KOR      2019   52.2    42759        Asia      \n\n            Spain                 ESP      2019   86.24   40802       Europe     \n\n          Sri Lanka               LKA      2019   34.97   13070        Asia      \n\n            Sudan                 SDN      2019   65.78    4174       Africa     \n\n           Suriname               SUR      2019   84.8    19037    South America \n\n            Sweden                SWE      2019   59.33   52851       Europe     \n\n         Switzerland              CHE      2019   80.39   70944       Europe     \n\n          Tajikistan              TJK      2019   38.6     3581        Asia      \n\n           Tanzania               TZA      2019   75.93    2661       Africa     \n\n           Thailand               THA      2019   77.51   18453        Asia      \n\n            Timor                 TLS      2019   14.87    3627        Asia      \n\n             Togo                 TGO      2019   8.13     2122       Africa     \n\n     Trinidad and Tobago          TTO      2019   55.02   25828    North America \n\n           Tunisia                TUN      2019   100.6   11417       Africa     \n\n            Turkey                TUR      2019   128.2   28197        Asia      \n\n         Turkmenistan             TKM      2019   55.94   15538        Asia      \n\n            Uganda                UGA      2019   171.9    2183       Africa     \n\n           Ukraine                UKR      2019   61.14   12805       Europe     \n\n     United Arab Emirates         ARE      2019   56.07   68264        Asia      \n\n        United Kingdom            GBR      2019   78.78   47369       Europe     \n\n        United States             USA      2019   106.7   62631    North America \n\n           Uruguay                URY      2019   76.34   23033    South America \n\n          Uzbekistan              UZB      2019   109.4    7348        Asia      \n\n           Vanuatu                VUT      2019   73.35    3137       Oceania    \n\n           Vietnam                VNM      2019   74.91    8041        Asia      \n\n            World               OWID_WRL   2019   78.72   16897        Asia      \n\n            Zambia                ZMB      2019   7.59     3470       Africa     \n\n           Zimbabwe               ZWE      2019   14.33    3630       Africa     \n---------------------------------------------------------------------------------\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph1 <- ggplot(data=df1, mapping=aes(x=gdp, y=fruit, color =Continent))+\n  geom_point()+\n  scale_x_continuous(trans = \"log\",\n                     breaks = c(1000,2000,5000,10000,20000,50000,100000),\n                     limits = c(1000, 100000),\n                     labels = scales::dollar_format(accuracy =1))+\n  scale_y_continuous(breaks = seq(0, 350, 50),\n                     labels=c(\"0 kg\",\"50 kg\", \"100 kg\", \"150 kg\", \"200 kg\", \"250 kg\",\"300 kg\", \"350 kg\"),\n                    #unit_format(suffix =\"kg\")\n                    #labels= function(y)(paste(y,\"kg\", sep=\" \")\n                    #labels = `paste(.x, \"kg\", sep =\" \")\n                     expand = expansion(mult = c(0.015, .05)) # default is .05 is either end\n                    \n                    )+\n  theme_minimal()+\n  theme(axis.line.x.bottom = element_line(color = \"black\"),\n        panel.grid = element_line(linetype = \"dashed\"),\n        panel.grid.minor = element_blank(),\n        legend.justification = \"top\",\n        plot.caption = element_text(hjust = 0),\n        plot.title.position = \"plot\",\n        plot.caption.position = \"plot\"\n        )+\n  guides(color= guide_legend(override.aes = list(shape = 15, size = 3)))+\n  labs(color = NULL, \n       title = \"Fruit consumption vs GDP per capita, 2019\",\n       subtitle = \"Average per capita fruit consumption, mesured in kilograms per year versus gross domestic product(GDP) per capita, measured in constant international-$.\",\n       x=\"GDP per capita\",\n       y=\"Fruit supply per person\",\n       caption = \"Source: Food and Agriculture Organization of the United Nations, Data compiled from multiple sources by World Bank OurWorldInData.org/edit-compositions. CC BY\")\n\ngraph1\n```\n\n::: {.cell-output-display}\n![](./unnamed-chunk-6-1.png){width=1008}\n:::\n:::\n\n\n\n### graph2\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- df1%>%\n  filter(Entity %in% c(\"China\", \"South Korea\", \"Japan\"))\n\n#graph1 + geom_label(p1, mapping =aes(gdp, fruit, label = Entity), nudge_x = 0.25,nudge_y = 0.25, check_overlap = T)\n\ngraph2 <- graph1+geom_label_repel(p1, mapping =aes(gdp, fruit, label = Entity), nudge_x = 0.25,nudge_y = 0.25)+ labs(title = \"Fruit Consumtpion of Three East Asia countries\", subtitle = \"\")\ngraph2\n```\n\n::: {.cell-output-display}\n![](./unnamed-chunk-8-1.png){width=1008}\n:::\n:::\n\ngraph2) I tried to highlights to three countries which are China, South Korea, Japan.\n\n\n### graph3\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- df1%>%\n  filter(Continent ==\"Asia\")\n\ngraph3 <- graph1 +scale_colour_grey()+\n  geom_point(data=p2, mapping=aes(x=gdp, y=fruit), color = \"red\")+\n  labs(title = \"Fruit Consumption in Asia\", subtitle = \"\")+\n  annotate(geom=\"text\", x=50000, y=250, label=\"Asia\",\n              color=\"red\", fontface=\"italic\", size= 13)\ngraph3\n```\n\n::: {.cell-output-display}\n![](./unnamed-chunk-10-1.png){width=1008}\n:::\n:::\n\ngraph3) I emphasizes on continent \"Asia\". \n\n\n\n","srcMarkdownNoYaml":"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(pander)\nlibrary(ggrepel)\n```\n:::\n\n### Elevator pitch\nI notice that countries in Asia follow the pattern about consuming of fruit. In China, they eat more fruit than Japan and South Korea even though they have less GDP. By making graph, I learned the skills that add annotate and add text in the graph by using a geom_label_repel function. Also, I learned how to design scale on axis in graph1 by using scale continuous.\n\n## Running Code\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read.csv(\"C:/Users/gakyeong/Documents/GitHub/DS350_WI23_Bae_Gaky/week_05/fruit-consumption-vs-gdp-per-capita.csv\")\n\ndf1 <- df %>%\n  rename(fruit = \"Fruit...00002919....Food.available.for.consumption...0645pc....kilograms.per.year.per.capita\", gdp = \"GDP.per.capita..PPP..constant.2017.international...\" )%>% drop_na()\n  \ndf1[df1 == \"\"]<-NA\n\ndf1 <-df1 %>% \n  filter(Year >= 2015)%>%\n  fill(Continent, .direction=\"down\")%>%\n  filter(Year == 2019)\npander(df1)\n```\n\n::: {.cell-output-display}\n---------------------------------------------------------------------------------\n            Entity                Code     Year   fruit    gdp       Continent   \n------------------------------ ---------- ------ ------- -------- ---------------\n         Afghanistan              AFG      2019   39.45    2065        Asia      \n\n           Albania                ALB      2019   179.6   13657       Europe     \n\n           Algeria                DZA      2019   108.4   11522       Africa     \n\n            Angola                AGO      2019   76.34    6670       Africa     \n\n     Antigua and Barbuda          ATG      2019   131.7   21850    North America \n\n          Argentina               ARG      2019   80.54   22066    South America \n\n           Armenia                ARM      2019    116    13654        Asia      \n\n          Australia               AUS      2019   65.07   49309       Oceania    \n\n           Austria                AUT      2019   92.75   55834       Europe     \n\n          Azerbaijan              AZE      2019   85.5    14442        Asia      \n\n           Bahamas                BHS      2019   145.6   36433    North America \n\n          Bangladesh              BGD      2019   28.76    4754        Asia      \n\n           Barbados               BRB      2019   68.3    15639    North America \n\n           Belarus                BLR      2019   74.19   19279       Europe     \n\n           Belgium                BEL      2019   99.09   51944       Europe     \n\n            Belize                BLZ      2019   105.9    7252    North America \n\n            Benin                 BEN      2019   43.8     3287       Africa     \n\n           Bolivia                BOL      2019   94.48    8724    South America \n\n    Bosnia and Herzegovina        BIH      2019   90.25   14897       Europe     \n\n           Botswana               BWA      2019   26.18   16348       Africa     \n\n            Brazil                BRA      2019   98.92   14764    South America \n\n           Bulgaria               BGR      2019   61.66   23266       Europe     \n\n         Burkina Faso             BFA      2019   5.21     2176       Africa     \n\n           Burundi                BDI      2019   79.06   751.7       Africa     \n\n           Cambodia               KHM      2019   14.99    4389        Asia      \n\n           Cameroon               CMR      2019   110.4    3743       Africa     \n\n            Canada                CAN      2019   96.76   49172    North America \n\n          Cape Verde              CPV      2019   46.86    7172       Africa     \n\n   Central African Republic       CAF      2019   52.44   945.1       Africa     \n\n             Chad                 TCD      2019   7.38     1580       Africa     \n\n            Chile                 CHL      2019   56.3    24968    South America \n\n            China                 CHN      2019   102.4   15978        Asia      \n\n           Colombia               COL      2019    145    14585    South America \n\n           Comoros                COM      2019   32.06    3059       Africa     \n\n            Congo                 COG      2019   44.07    3826       Africa     \n\n          Costa Rica              CRI      2019   114.1   20938    North America \n\n        Cote d'Ivoire             CIV      2019   67.27    5213       Africa     \n\n           Croatia                HRV      2019   72.99   29336       Europe     \n\n            Cyprus                CYP      2019   74.65   41522       Europe     \n\n           Czechia                CZE      2019   55.73   40981       Europe     \n\n Democratic Republic of Congo     COD      2019   64.21    1098       Africa     \n\n           Denmark                DNK      2019   59.68   57162       Europe     \n\n           Djibouti               DJI      2019   30.44    5535       Africa     \n\n           Dominica               DMA      2019   365.6   12369    North America \n\n      Dominican Republic          DOM      2019   354.8   18413    North America \n\n           Ecuador                ECU      2019   57.6    11371    South America \n\n            Egypt                 EGY      2019   93.34   11763       Africa     \n\n         El Salvador              SLV      2019   68.48    8776    North America \n\n           Estonia                EST      2019   75.44   36401       Europe     \n\n           Eswatini               SWZ      2019   94.51    8653       Africa     \n\n           Ethiopia               ETH      2019   8.81     2221       Africa     \n\n             Fiji                 FJI      2019   38.21   13684       Oceania    \n\n           Finland                FIN      2019   73.06   48583       Europe     \n\n            France                FRA      2019   91.16   46018       Europe     \n\n            Gabon                 GAB      2019   134.1   14946       Africa     \n\n            Gambia                GMB      2019   6.841    2225       Africa     \n\n           Georgia                GEO      2019   49.31   14989        Asia      \n\n           Germany                DEU      2019   75.48   53930       Europe     \n\n            Ghana                 GHA      2019   202.3    5540       Africa     \n\n            Greece                GRC      2019    144    29698       Europe     \n\n           Grenada                GRD      2019   119.7   16868    North America \n\n          Guatemala               GTM      2019   48.54    8653    North America \n\n            Guinea                GIN      2019   89.86    2567       Africa     \n\n        Guinea-Bissau             GNB      2019   54.21    1939       Africa     \n\n            Guyana                GUY      2019    164    13082    South America \n\n            Haiti                 HTI      2019   98.42    3073    North America \n\n           Honduras               HND      2019   55.77    5736    North America \n\n          Hong Kong               HKG      2019   74.32   59586        Asia      \n\n           Hungary                HUN      2019   71.83   32554       Europe     \n\n           Iceland                ISL      2019   87.39   56936       Europe     \n\n            India                 IND      2019   63.55    6714        Asia      \n\n          Indonesia               IDN      2019   68.97   11812        Asia      \n\n             Iran                 IRN      2019   144.2   12389        Asia      \n\n             Iraq                 IRQ      2019   66.71   10936        Asia      \n\n           Ireland                IRL      2019   68.41   86650       Europe     \n\n            Israel                ISR      2019   107.4   40626        Asia      \n\n            Italy                 ITA      2019    123    42708       Europe     \n\n           Jamaica                JAM      2019    109     9777    North America \n\n            Japan                 JPN      2019   33.35   42022        Asia      \n\n            Jordan                JOR      2019   39.81   10071        Asia      \n\n          Kazakhstan              KAZ      2019   49.3    26352        Asia      \n\n            Kenya                 KEN      2019   64.68    4453       Africa     \n\n           Kiribati               KIR      2019   73.91    2340       Oceania    \n\n            Kuwait                KWT      2019   57.73   49854        Asia      \n\n          Kyrgyzstan              KGZ      2019   32.63    5258        Asia      \n\n             Laos                 LAO      2019   130.2    7887        Asia      \n\n            Latvia                LVA      2019    49     31012       Europe     \n\n           Lebanon                LBN      2019   85.26   14564        Asia      \n\n           Lesotho                LSO      2019   16.02    2584       Africa     \n\n           Liberia                LBR      2019   40.14    1470       Africa     \n\n            Libya                 LBY      2019   71.53   15174       Africa     \n\n          Lithuania               LTU      2019   47.31   37166       Europe     \n\n          Luxembourg              LUX      2019   86.87   116518      Europe     \n\n            Macao                 MAC      2019   57.34   127273       Asia      \n\n          Madagascar              MDG      2019   42.9     1619       Africa     \n\n            Malawi                MWI      2019   190.1    1537       Africa     \n\n           Malaysia               MYS      2019   41.15   28421        Asia      \n\n           Maldives               MDV      2019   71.31   19510        Asia      \n\n             Mali                 MLI      2019   66.26    2322       Africa     \n\n            Malta                 MLT      2019   80.94   43951       Europe     \n\n          Mauritania              MRT      2019   13.13    5344       Africa     \n\n          Mauritius               MUS      2019   40.98   22870       Africa     \n\n            Mexico                MEX      2019   120.3   19677    North America \n\n           Moldova                MDA      2019   127.2   13027       Europe     \n\n           Mongolia               MNG      2019   12.08   12486        Asia      \n\n          Montenegro              MNE      2019   151.8   21534       Europe     \n\n           Morocco                MAR      2019   108.5    7547       Africa     \n\n          Mozambique              MOZ      2019   30.85    1282       Africa     \n\n           Myanmar                MMR      2019   48.29    4740        Asia      \n\n           Namibia                NAM      2019   27.62    9813       Africa     \n\n            Nepal                 NPL      2019   54.71    3953        Asia      \n\n         Netherlands              NLD      2019   101.6   56784       Europe     \n\n         New Zealand              NZL      2019   57.38   42878       Oceania    \n\n          Nicaragua               NIC      2019   46.46    5452    North America \n\n            Niger                 NER      2019   25.32    1224       Africa     \n\n           Nigeria                NGA      2019   54.93    5135       Africa     \n\n        North America              NA      2019   110.5   61251       Africa     \n\n       North Macedonia            MKD      2019   113.6   16773       Europe     \n\n            Norway                NOR      2019   77.24   64385       Europe     \n\n             Oman                 OMN      2019   134.1   31284        Asia      \n\n           Pakistan               PAK      2019   35.6     4698        Asia      \n\n            Panama                PAN      2019   76.47   31440    North America \n\n       Papua New Guinea           PNG      2019   259.8    4293       Oceania    \n\n           Paraguay               PRY      2019   76.08   12616    South America \n\n             Peru                 PER      2019   130.9   12854    South America \n\n         Philippines              PHL      2019    101     8915        Asia      \n\n            Poland                POL      2019   61.83   33185       Europe     \n\n           Portugal               PRT      2019   131.6   34946       Europe     \n\n           Romania                ROU      2019   107.1   29875       Europe     \n\n            Russia                RUS      2019   61.24   27211       Europe     \n\n            Rwanda                RWA      2019   179.2    2228       Africa     \n\n    Saint Kitts and Nevis         KNA      2019   68.42   28603    North America \n\n         Saint Lucia              LCA      2019   87.97   15201    North America \n\n    Saint Vincent and the         VCT      2019   153.9   12489    North America \n          Grenadines                                                             \n\n            Samoa                 WSM      2019   177.3    6632       Oceania    \n\n    Sao Tome and Principe         STP      2019   210.3    4005       Africa     \n\n         Saudi Arabia             SAU      2019   69.65   46962        Asia      \n\n           Senegal                SEN      2019   19.36    3361       Africa     \n\n            Serbia                SRB      2019    105    18307       Europe     \n\n          Seychelles              SYC      2019   86.19   27611       Africa     \n\n         Sierra Leone             SLE      2019   33.74    1705       Africa     \n\n           Slovakia               SVK      2019   51.61   31928       Europe     \n\n           Slovenia               SVN      2019   95.6    38947       Europe     \n\n       Solomon Islands            SLB      2019   42.1     2661       Oceania    \n\n         South Africa             ZAF      2019   27.14   13710       Africa     \n\n         South Korea              KOR      2019   52.2    42759        Asia      \n\n            Spain                 ESP      2019   86.24   40802       Europe     \n\n          Sri Lanka               LKA      2019   34.97   13070        Asia      \n\n            Sudan                 SDN      2019   65.78    4174       Africa     \n\n           Suriname               SUR      2019   84.8    19037    South America \n\n            Sweden                SWE      2019   59.33   52851       Europe     \n\n         Switzerland              CHE      2019   80.39   70944       Europe     \n\n          Tajikistan              TJK      2019   38.6     3581        Asia      \n\n           Tanzania               TZA      2019   75.93    2661       Africa     \n\n           Thailand               THA      2019   77.51   18453        Asia      \n\n            Timor                 TLS      2019   14.87    3627        Asia      \n\n             Togo                 TGO      2019   8.13     2122       Africa     \n\n     Trinidad and Tobago          TTO      2019   55.02   25828    North America \n\n           Tunisia                TUN      2019   100.6   11417       Africa     \n\n            Turkey                TUR      2019   128.2   28197        Asia      \n\n         Turkmenistan             TKM      2019   55.94   15538        Asia      \n\n            Uganda                UGA      2019   171.9    2183       Africa     \n\n           Ukraine                UKR      2019   61.14   12805       Europe     \n\n     United Arab Emirates         ARE      2019   56.07   68264        Asia      \n\n        United Kingdom            GBR      2019   78.78   47369       Europe     \n\n        United States             USA      2019   106.7   62631    North America \n\n           Uruguay                URY      2019   76.34   23033    South America \n\n          Uzbekistan              UZB      2019   109.4    7348        Asia      \n\n           Vanuatu                VUT      2019   73.35    3137       Oceania    \n\n           Vietnam                VNM      2019   74.91    8041        Asia      \n\n            World               OWID_WRL   2019   78.72   16897        Asia      \n\n            Zambia                ZMB      2019   7.59     3470       Africa     \n\n           Zimbabwe               ZWE      2019   14.33    3630       Africa     \n---------------------------------------------------------------------------------\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph1 <- ggplot(data=df1, mapping=aes(x=gdp, y=fruit, color =Continent))+\n  geom_point()+\n  scale_x_continuous(trans = \"log\",\n                     breaks = c(1000,2000,5000,10000,20000,50000,100000),\n                     limits = c(1000, 100000),\n                     labels = scales::dollar_format(accuracy =1))+\n  scale_y_continuous(breaks = seq(0, 350, 50),\n                     labels=c(\"0 kg\",\"50 kg\", \"100 kg\", \"150 kg\", \"200 kg\", \"250 kg\",\"300 kg\", \"350 kg\"),\n                    #unit_format(suffix =\"kg\")\n                    #labels= function(y)(paste(y,\"kg\", sep=\" \")\n                    #labels = `paste(.x, \"kg\", sep =\" \")\n                     expand = expansion(mult = c(0.015, .05)) # default is .05 is either end\n                    \n                    )+\n  theme_minimal()+\n  theme(axis.line.x.bottom = element_line(color = \"black\"),\n        panel.grid = element_line(linetype = \"dashed\"),\n        panel.grid.minor = element_blank(),\n        legend.justification = \"top\",\n        plot.caption = element_text(hjust = 0),\n        plot.title.position = \"plot\",\n        plot.caption.position = \"plot\"\n        )+\n  guides(color= guide_legend(override.aes = list(shape = 15, size = 3)))+\n  labs(color = NULL, \n       title = \"Fruit consumption vs GDP per capita, 2019\",\n       subtitle = \"Average per capita fruit consumption, mesured in kilograms per year versus gross domestic product(GDP) per capita, measured in constant international-$.\",\n       x=\"GDP per capita\",\n       y=\"Fruit supply per person\",\n       caption = \"Source: Food and Agriculture Organization of the United Nations, Data compiled from multiple sources by World Bank OurWorldInData.org/edit-compositions. CC BY\")\n\ngraph1\n```\n\n::: {.cell-output-display}\n![](./unnamed-chunk-6-1.png){width=1008}\n:::\n:::\n\n\n\n### graph2\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- df1%>%\n  filter(Entity %in% c(\"China\", \"South Korea\", \"Japan\"))\n\n#graph1 + geom_label(p1, mapping =aes(gdp, fruit, label = Entity), nudge_x = 0.25,nudge_y = 0.25, check_overlap = T)\n\ngraph2 <- graph1+geom_label_repel(p1, mapping =aes(gdp, fruit, label = Entity), nudge_x = 0.25,nudge_y = 0.25)+ labs(title = \"Fruit Consumtpion of Three East Asia countries\", subtitle = \"\")\ngraph2\n```\n\n::: {.cell-output-display}\n![](./unnamed-chunk-8-1.png){width=1008}\n:::\n:::\n\ngraph2) I tried to highlights to three countries which are China, South Korea, Japan.\n\n\n### graph3\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- df1%>%\n  filter(Continent ==\"Asia\")\n\ngraph3 <- graph1 +scale_colour_grey()+\n  geom_point(data=p2, mapping=aes(x=gdp, y=fruit), color = \"red\")+\n  labs(title = \"Fruit Consumption in Asia\", subtitle = \"\")+\n  annotate(geom=\"text\", x=50000, y=250, label=\"Asia\",\n              color=\"red\", fontface=\"italic\", size= 13)\ngraph3\n```\n\n::: {.cell-output-display}\n![](./unnamed-chunk-10-1.png){width=1008}\n:::\n:::\n\ngraph3) I emphasizes on continent \"Asia\". \n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":10.5,"fig-height":7.5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":true,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"fruit_consumption.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"Search","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","theme":["cosmo","brand"],"js":"../../scripts.js","title":"Fruit Consumption Analysis","subtitle":"__R:dplyr, ggplot"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}